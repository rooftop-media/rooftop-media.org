<template>
  <h2>Calendar</h2>
  <div id="calendar">
    <div id="calendar-title">
      <div class="calendar-nav-button">&#10094;</div>
      <div class="month-and-year">
        <span id="month"></span>
        <span id="year"></span>
      </div>
      <div class="calendar-nav-button">&#10095;</div>
    </div>
    <div id="weekday-names">
      <div class="weekday-name">Monday</div>
      <div class="weekday-name">Tuesday</div>
      <div class="weekday-name">Wednesday</div>
      <div class="weekday-name">Thursday</div>
      <div class="weekday-name">Friday</div>
      <div class="weekday-name">Saturday</div>
      <div class="weekday-name">Sunday</div>
    </div>
    <div id="calendar-weeks">
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
      <div class="calendar-day"></div>
    </div>
  </div>
</template>

<script>

  if (!month_shift || typeof month_shift === 'undefined') {
    let month_shift = 0; 
    let year_shift = 0;

    let year = 0;
    let month = '';
    let month_day_amt = 0;
    let current_date = 0;

    let starting_weekday = 0;
    let month_end_padding = 0;
  }

  //  Get data to display the current calendar. 
  function populate_calendar() {
    var d = new Date();
    var month_num = d.getMonth() + month_shift;
    year = d.getFullYear() + year_shift;
    document.getElementById('year').innerHTML = year;

    d.setMonth(month_num);
    d.setFullYear(year);
    const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    const month_days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
    month = months[month_num];
    document.getElementById('month').innerHTML = month;

    month_day_amt = month_days[month_num];
    //  Getting the current date, if relevant to this month. 
    current_date = d.getDate();
    if (month_shift != 0 || year_shift != 0) {
        current_date = -1;
    }
    //  Getting the month's starting week day. 
    d.setDate(1);
    starting_weekday = d.getDay();
    
    //  Padding the end of the month
    d.setDate(month_day_amt);
    month_end_padding = 7 - d.getDay();

    //  Draw the days.
    document.getElementById('calendar-weeks').innerHTML = "";
    for (let i = 0; i < starting_weekday; i++) {
      document.getElementById('calendar-weeks').innerHTML += '<div class="calendar-day"></div>';
    }
    for (let i = 0; i < month_day_amt; i++) {
      if ((i+1) == current_date) {
        document.getElementById('calendar-weeks').innerHTML += `<div class="calendar-day"><div class="day-num current">${i+1}</div></div>`;
      } else {
        document.getElementById('calendar-weeks').innerHTML += `<div class="calendar-day"><div class="day-num">${i+1}</div></div>`;
      }
    }
    for (let i = 0; i < month_end_padding - 1; i++) {
      document.getElementById('calendar-weeks').innerHTML += `<div class="calendar-day"></div>`;
    }
  }
  populate_calendar();

  function shift_calendar(direction) {
    var d = new Date();
    this.month_shift += direction;
    if (d.getMonth() + this.month_shift >= 12) {
        this.month_shift = 0 - d.getMonth();
        this.year_shift++;
    } else if (d.getMonth() + this.month_shift < 0) {
        this.month_shift = 11 - d.getMonth();
        this.year_shift--;
    }
    this.populate_calendar();
  }
</script>

<style>
  #calendar {
    width: 800px;
  }
  #calendar-title {
    width: 100%;
    border: solid 1px black;
    display: flex;
    justify-content: space-between;
    padding: 10px;
    box-sizing: border-box;
  }
  #weekday-names {
    width: 100%;
    display: flex;
  }
  .weekday-name {
    border: solid 1px black;
    width: calc(100% / 7);
    text-align: center;
    padding: 10px 0px;
  }

  #calendar-weeks {
    width: 100%;
    display: flex;
    flex-wrap: wrap;
  }
  .calendar-day {
    border: solid 1px black;
    width: calc((100% / 7) - 2px);
    text-align: center;
    padding: 10px 0px;
    height: 80px;
    font-family: sans-serif;
  }
  .day-num {
    text-align: left;
    width: 25px;
    height: 25px;
    margin: 0px 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: sans-serif;
  }
  .day-num.current {
    background: maroon;
    font-weight: bold;
    color: white;
    border-radius: 50%;
  }
</style>